<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MealZip</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; background-color: #f8f9fa; }
        .container { text-align: center; background: white; padding: 40px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 300px; }
        .btn { background: #4285F4; color: white; border: none; padding: 12px; width: 100%; border-radius: 6px; font-size: 16px; cursor: pointer; margin-top: 10px; }
        .btn:hover { background: #357ae8; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div id="login-box" class="container">
        <h1>ğŸ³ MealZip</h1>
        <p>ë‚˜ë§Œì˜ ì‹ë‹¨ ê´€ë¦¬</p>
        <button onclick="handleLogin()" class="btn">êµ¬ê¸€ ë¡œê·¸ì¸</button>
    </div>

    <div id="app-box" class="container hidden">
        <h2>í™˜ì˜í•©ë‹ˆë‹¤! ğŸ‰</h2>
        <p id="user-msg">ë¡œë”© ì¤‘...</p>
        <button onclick="handleLogout()" class="btn" style="background:#666;">ë¡œê·¸ì•„ì›ƒ</button>
        <hr style="margin: 20px 0;">
        <p style="color: blue;">ë¡œê·¸ì¸ ì„±ê³µ!</p>
        <p>ì´ì œ ê¸°ì¡´ ì½”ë“œë¥¼ í•©ì¹˜ë©´ ë©ë‹ˆë‹¤.</p>
    </div>

    <script>
        // 1. ì„¤ì • (ì œê³µí•´ì£¼ì‹  í‚¤ ì ìš© ì™„ë£Œ)
        const supabaseUrl = 'https://ztwlntjqqlhjabvdmrkr.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp0d2xudGpxcWxoamFidmRtcmtyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk1Mjk2NzEsImV4cCI6MjA4NTEwNTY3MX0.EbGsBamR1G8UvRseq6Fc8ul-UHfR_jCPfVg267fF1wc';

        // 2. ì‹¤í–‰ (ì—¬ê¸°ì„œ ì—ëŸ¬ê°€ ë‚˜ë©´ ì•ˆë¨)
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        // 3. ê¸°ëŠ¥
        async function handleLogin() {
            await supabase.auth.signInWithOAuth({
                provider: 'google',
                options: { queryParams: { access_type: 'offline', prompt: 'consent' } }
            });
        }

        async function handleLogout() {
            await supabase.auth.signOut();
            location.reload();
        }

        supabase.auth.onAuthStateChange((event, session) => {
            const loginBox = document.getElementById('login-box');
            const appBox = document.getElementById('app-box');
            if (session) {
                loginBox.classList.add('hidden');
                appBox.classList.remove('hidden');
                document.getElementById('user-msg').innerText = session.user.email + "ë‹˜";
            } else {
                loginBox.classList.remove('hidden');
                appBox.classList.add('hidden');
            }
        });
    </script>
</body>
</html>
